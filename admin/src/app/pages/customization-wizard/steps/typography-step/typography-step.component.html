<div class="mx-auto max-w-5xl space-y-8">
  <!-- Header -->
  <div class="mb-8">
    <h2 class="text-3xl font-bold text-gray-900 dark:text-white tracking-tight">{{ t("customization.typography.title") }}</h2>
    <p class="mt-2 text-lg text-gray-600 dark:text-gray-300">
      {{ t("customization.typography.subtitle") }}
    </p>
  </div>

  @if (typography(); as currentTypography) {
    <!-- Font Families Section -->
    <div class="group rounded-2xl bg-white/60 dark:bg-gray-800/60 p-6 md:p-8 shadow-xl shadow-gray-200/50 dark:shadow-black/20 backdrop-blur-md border border-white/20 dark:border-gray-700/50 transition-all hover:shadow-2xl hover:shadow-indigo-900/5 dark:hover:shadow-black/30">
      <div class="mb-6 flex items-center gap-4">
        <div class="flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 shadow-lg shadow-indigo-500/20 group-hover:scale-110 transition-transform duration-300">
          <cms-icon name="font" [style]="'solid'"  class="h-6 w-6 text-white"></cms-icon>
        </div>
        <div>
          <h3 class="text-xl font-bold text-gray-900 dark:text-white">{{ t("customization.typography.fontFamilies") }}</h3>
          <p class="text-sm text-gray-500 dark:text-gray-400">{{ t("customization.typography.fontFamiliesDescription") }}</p>
        </div>
      </div>

      <div class="grid grid-cols-1 gap-6 md:grid-cols-3">
        <!-- Primary Font -->
        <div class="rounded-xl border border-gray-200 dark:border-gray-700 bg-white/50 dark:bg-gray-900/50 p-5 shadow-sm transition-all hover:shadow-md hover:border-indigo-200 dark:hover:border-indigo-900">
          <label for="primary-font" class="mb-3 block text-sm font-bold text-gray-900 dark:text-white flex items-center">
            <span class="w-8 h-8 rounded-lg bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 flex items-center justify-center mr-3">
              <span class="text-xs font-serif">Aa</span>
            </span>
            {{ t("customization.typography.primaryFont") }}
          </label>
          <p class="mb-4 text-xs text-gray-500 dark:text-gray-400">{{ t("customization.typography.primaryFontDescription") }}</p>
          <div class="relative">
            <cms-select
              [options]="primaryFontOptions"
              [ngModel]="currentTypography.primaryFontFamily"
              (ngModelChange)="updateFontFamily('primaryFontFamily', $event); loadGoogleFont($event)"
              optionLabel="label"
              optionValue="value"
              placeholder="Select a font"
            ></cms-select>
          </div>
          <div class="mt-4 rounded-lg bg-gray-50 dark:bg-gray-950 p-4 text-center border border-gray-100 dark:border-gray-800" [style.font-family]="currentTypography.primaryFontFamily">
            <span class="text-2xl font-bold text-gray-800 dark:text-gray-200">AaBbCc 123</span>
          </div>
        </div>

        <!-- Secondary Font -->
        <div class="rounded-xl border border-gray-200 dark:border-gray-700 bg-white/50 dark:bg-gray-900/50 p-5 shadow-sm transition-all hover:shadow-md hover:border-purple-200 dark:hover:border-purple-900">
          <label for="secondary-font" class="mb-3 block text-sm font-bold text-gray-900 dark:text-white flex items-center">
             <span class="w-8 h-8 rounded-lg bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 flex items-center justify-center mr-3">
              <cms-icon name="align-left" size="sm"></cms-icon>
            </span>
            {{ t("customization.typography.secondaryFont") }}
          </label>
          <p class="mb-4 text-xs text-gray-500 dark:text-gray-400">{{ t("customization.typography.secondaryFontDescription") }}</p>
          <div class="relative">
            <cms-select
              [options]="secondaryFontOptions"
              [ngModel]="currentTypography.secondaryFontFamily"
              (ngModelChange)="updateFontFamily('secondaryFontFamily', $event); loadGoogleFont($event)"
              optionLabel="label"
              optionValue="value"
              placeholder="Select a font"
            ></cms-select>
          </div>
          <div class="mt-4 rounded-lg bg-gray-50 dark:bg-gray-950 p-4 text-center border border-gray-100 dark:border-gray-800" [style.font-family]="currentTypography.secondaryFontFamily">
            <span class="text-lg text-gray-700 dark:text-gray-300">The quick brown fox jumps over the lazy dog.</span>
          </div>
        </div>

        <!-- Monospace Font -->
        <div class="rounded-xl border border-gray-200 dark:border-gray-700 bg-white/50 dark:bg-gray-900/50 p-5 shadow-sm transition-all hover:shadow-md hover:border-gray-300 dark:hover:border-gray-600">
          <label for="monospace-font" class="mb-3 block text-sm font-bold text-gray-900 dark:text-white flex items-center">
             <span class="w-8 h-8 rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 flex items-center justify-center mr-3">
              <cms-icon name="code" size="sm"></cms-icon>
            </span>
            {{ t("customization.typography.monospaceFont") }}
          </label>
          <p class="mb-4 text-xs text-gray-500 dark:text-gray-400">{{ t("customization.typography.monospaceFontDescription") }}</p>
          <div class="relative">
            <cms-select
              [options]="monoFontOptions"
              [ngModel]="currentTypography.monoFontFamily"
              (ngModelChange)="updateFontFamily('monoFontFamily', $event); loadGoogleFont($event)"
              optionLabel="label"
              optionValue="value"
              placeholder="Select a font"
            ></cms-select>
          </div>
          <div class="mt-4 rounded-lg bg-gray-900 p-4 text-center border border-gray-800" [style.font-family]="currentTypography.monoFontFamily">
            <span class="text-sm font-mono text-green-400">console.log("Hello World");</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Text Styles Section -->
    <div class="space-y-6">
      @for (group of textStyleGroups; track group.title) {
        <div class="group rounded-2xl bg-white/60 dark:bg-gray-800/60 p-6 shadow-xl shadow-gray-200/50 dark:shadow-black/20 backdrop-blur-md border border-white/20 dark:border-gray-700/50">
          <!-- Group header -->
          <div class="mb-6 flex items-center gap-4">
            <div class="flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 shadow-lg shadow-blue-500/20 group-hover:scale-110 transition-transform duration-300">
              <cms-icon [name]="group.icon" [style]="'solid'"  class="h-6 w-6 text-white"></cms-icon>
            </div>
            <div>
              <h3 class="text-xl font-bold text-gray-900 dark:text-white">{{ t(group.title) || group.title }}</h3>
              <p class="text-sm text-gray-500 dark:text-gray-400">{{ t(group.description) || group.description }}</p>
            </div>
          </div>

          <!-- Text style rows -->
          <div class="space-y-4">
            @for (style of group.styles; track style.key) {
              <div class="overflow-hidden rounded-xl border border-gray-200 dark:border-gray-700 bg-white/40 dark:bg-gray-900/40">
                <!-- Style header -->
                <div class="bg-gray-50/80 dark:bg-gray-800/80 px-5 py-3 border-b border-gray-200 dark:border-gray-700">
                  <div class="flex items-center justify-between">
                    <div>
                      <span class="font-bold text-gray-900 dark:text-white">{{ t(style.label) || style.label }}</span>
                      <span class="ml-2 text-xs text-gray-500 dark:text-gray-400">{{ t(style.description) || style.description }}</span>
                    </div>
                  </div>
                </div>

                <!-- Style controls and preview -->
                <div class="grid grid-cols-1 gap-6 p-5 lg:grid-cols-2">
                  <!-- Controls -->
                  <div class="space-y-5">
                    <!-- Font Size -->
                    <div>
                      <div class="flex justify-between mb-1">
                        <label [for]="'font-size-' + style.key" class="block text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">{{ t("customization.typography.fontSize") }}</label>
                        <span class="text-xs text-blue-600 dark:text-blue-400 tabular-nums font-mono">{{ getFontSizeLabel(getTextStyle(style.key).fontSize) }}</span>
                      </div>
                      <div class="flex items-center gap-3">
                        <input
                          [id]="'font-size-' + style.key"
                          type="range"
                          min="0"
                          [max]="fontSizes.length - 1"
                          step="1"
                          [value]="getFontSizeIndex(getTextStyle(style.key).fontSize)"
                          (input)="updateFontSizeFromIndex(style.key, +$any($event.target).value)"
                          class="flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 accent-blue-600"
                        />
                      </div>
                    </div>

                    <!-- Font Weight in Slider (User Request: "Use Tailwind Typography for Font Weight") -->
                    <div>
                      <div class="flex justify-between mb-1">
                         <label [for]="'font-weight-' + style.key" class="block text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">{{ t("customization.typography.fontWeight") }}</label>
                         <span class="text-xs text-blue-600 dark:text-blue-400 tabular-nums font-mono">{{ getFontWeightLabel(getTextStyle(style.key).fontWeight) }}</span>
                      </div>
                      <input
                          [id]="'font-weight-' + style.key"
                          type="range"
                          min="0"
                          [max]="fontWeights.length - 1"
                          step="1"
                          [value]="getFontWeightIndex(getTextStyle(style.key).fontWeight)"
                          (input)="updateFontWeightFromIndex(style.key, +$any($event.target).value)"
                          class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 accent-blue-600"
                        />
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                      <!-- Line Height -->
                      <div>
                        <div class="flex justify-between mb-1">
                          <label [for]="'line-height-' + style.key" class="block text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">{{ t("customization.typography.lineHeight") }}</label>
                          <span class="text-xs text-blue-600 dark:text-blue-400 tabular-nums font-mono">{{ getLineHeightLabel(getTextStyle(style.key).lineHeight) }}</span>
                        </div>
                        <input
                          [id]="'line-height-' + style.key"
                          type="range"
                          min="0"
                          [max]="lineHeights.length - 1"
                          step="1"
                          [value]="getLineHeightIndex(getTextStyle(style.key).lineHeight)"
                          (input)="updateLineHeightFromIndex(style.key, +$any($event.target).value)"
                           class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 accent-blue-600"
                        />
                      </div>

                      <!-- Letter Spacing -->
                      <div>
                        <div class="flex justify-between mb-1">
                          <label [for]="'letter-spacing-' + style.key" class="block text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">{{ t("customization.typography.letterSpacing") }}</label>
                          <span class="text-xs text-blue-600 dark:text-blue-400 tabular-nums font-mono">{{ getLetterSpacingLabel(getTextStyle(style.key).letterSpacing) }}</span>
                        </div>
                        <input
                          [id]="'letter-spacing-' + style.key"
                          type="range"
                          min="0"
                          [max]="letterSpacings.length - 1"
                          step="1"
                          [value]="getLetterSpacingIndex(getTextStyle(style.key).letterSpacing)"
                          (input)="updateLetterSpacingFromIndex(style.key, +$any($event.target).value)"
                           class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 accent-blue-600"
                        />
                      </div>
                    </div>

                    <!-- Text Transform -->
                    <div>
                      <span class="mb-1 block text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">{{ t("customization.typography.textTransform") }}</span>
                      <div class="flex flex-wrap gap-2 bg-gray-100 dark:bg-gray-800 rounded-lg p-2">
                        @for (transform of textTransformOptions; track transform.value) {
                          <cms-button
                            (pressed)="updateTextStyle(style.key, { textTransform: transform.value })"
                            [color]="getTextStyle(style.key).textTransform === transform.value ? 'primary' : 'secondary'"
                            size="xs"
                            class="flex-1"
                          >
                            {{ t(transform.label) || transform.label }}
                          </cms-button>
                        }
                      </div>
                    </div>
                  </div>

                  <!-- Live Preview -->
                  <div class="flex items-center justify-center rounded-xl bg-white dark:bg-gray-800 p-8 border border-gray-200 dark:border-gray-700 relative overflow-hidden">
                    <div class="absolute inset-0 bg-grid-pattern opacity-5"></div>
                    <div
                      class="text-center relative z-10 transition-all duration-300"
                      [style.font-family]="style.key <= 5 ? currentTypography.primaryFontFamily : currentTypography.secondaryFontFamily"
                      [class]="
                        getTailwindFontSizeClass(getTextStyle(style.key).fontSize) + ' ' +
                        getTailwindFontWeightClass(getTextStyle(style.key).fontWeight) + ' ' +
                        getTailwindLineHeightClass(getTextStyle(style.key).lineHeight) + ' ' +
                        getTailwindLetterSpacingClass(getTextStyle(style.key).letterSpacing) + ' ' +
                        getTailwindTextTransformClass(getTextStyle(style.key).textTransform)
                      "
                    >
                      <span class="text-gray-900 dark:text-white">{{ getPreviewText(style.key) }}</span>
                    </div>
                  </div>
                </div>
              </div>
            }
          </div>
        </div>
      }
    </div>

    <!-- Full Preview Section -->
    <div class="mt-8 rounded-2xl bg-white/60 dark:bg-gray-800/60 p-6 md:p-8 shadow-xl shadow-gray-200/50 dark:shadow-black/20 backdrop-blur-md border border-white/20 dark:border-gray-700/50">
      <h3 class="mb-6 text-xl font-bold text-gray-900 dark:text-white">{{ t("customization.typography.completePreview") }}</h3>
      <div class="space-y-6 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 p-8 shadow-inner">
        @for (group of textStyleGroups; track group.title) {
          @for (style of group.styles; track style.key) {
            <div
              [style.font-family]="style.key <= 5 ? currentTypography.primaryFontFamily : currentTypography.secondaryFontFamily"
              [class]="
                getTailwindFontSizeClass(getTextStyle(style.key).fontSize) + ' ' +
                getTailwindFontWeightClass(getTextStyle(style.key).fontWeight) + ' ' +
                getTailwindLineHeightClass(getTextStyle(style.key).lineHeight) + ' ' +
                getTailwindLetterSpacingClass(getTextStyle(style.key).letterSpacing) + ' ' +
                getTailwindTextTransformClass(getTextStyle(style.key).textTransform)
              "
              class="text-gray-900 dark:text-white"
            >
              {{ getPreviewText(style.key) }}
            </div>
          }
        }
      </div>
    </div>
  }
</div>
